
<html>
<head>
<style>
/* Created By Dilip Sahoo V1.0*/
table {
  width:100%;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
th, td {
  padding: 15px;
  text-align: left;
}
#t01 tr:nth-child(even) {
  background-color: #eee;
}
#t01 tr:nth-child(odd) {
 background-color: #fff;
}
#t01 th {
  background-color: black;
  color: white;
}
.container{
    display: flex;
}
.fixed{
    width: 900px;
    height: 500px;
}
.flex-item{
    width: 900px;
    height: 500px;
    flex-grow: 1;
}

 #container1 {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

body {font-family: Arial;}

/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}


</style>




</head>

<body>
<h1 style="text-align:center">Threat Attribution Result</h1>
<!--
<div id="piechart_3d" style="margin-right: auto; margin-left: auto; width: 900px; height: 500px;"></div>	
<div id="regions_div" style="clear: right; float: left; width: 900px; height: 500px;"></div> 
-->
<div class="tab">
  <button class="tablinks" onclick="openCity(event, 'MultiView')">General Info-MultiView</button>
  <button class="tablinks" onclick="openCity(event, 'BytecodeView')">BytecodeView</button>
  <button class="tablinks" onclick="openCity(event, 'OpcodeView')">OpcodeView</button>
  <button class="tablinks" onclick="openCity(event, 'HeaderView')">HeaderView</button>
 
</div>


<div id="MultiView" class="tabcontent" style="display:block">
 
<?php
$target_dir = "/var/www/html/uploads/";
$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
$uploadOk = 1;
$imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));
// Calculate SHA256 hash
if(isset($_POST["submit"])) {
 $sha256file = hash_file( 'sha256', $_FILES["fileToUpload"]["tmp_name"] );//true
 $md5file = sha1_file($_FILES["fileToUpload"]["tmp_name"]);
 //echo $sha256file;
 $uploadOk = 1;
}


$servername = "localhost";
$username = "s20";//change user name and pwd as required
$password = "malware";//change user name and pwd as required

// Create connection
$conn = new mysqli($servername, $username, $password);

// Check connection
if ($conn->connect_error) {
  die("Connection failed: " . $conn->connect_error);
}
//echo "Connected successfully";

$sql = "SELECT SHA256_HASH, BYTECODE_VIEW_PREDICTION,BYTECODE_VIEW_ACCURACY,  OPCODE_VIEW_PREDICTION,OPCODE_VIEW_ACCURACY, HEADER_VIEW_PREDICTION,HEADER_VIEW_ACCURACY, MULTI_CLASS_PREDICTION, multi_class_apt_profile,NATION_STATE,ACTION  FROM mysql.CTA_ATTRIBUTION_T T WHERE T.SHA256_HASH= '$sha256file' ";
$result = $conn->query($sql);
//$numrows = mysql_num_rows($result);
//echo mysql_num_rows($result);
//var_dump($result);
if ($result->num_rows > 0) {
       
           
?>

<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-radar.min.js"></script>
 <script>
    anychart.onDocumentReady(function () {
    // our data from bulbapedia
      var data1 = [
        {x: "APT1", value: 0},
        {x: "APT10", value: 0},
        {x: "APT19", value: 0},
        {x: "APT21", value: 0},
        {x: "APT28", value: 0},
        {x: "APT29", value: 0},
        {x: "APT30", value: 0},
        {x: "DarkHotel", value: 0},
        {x: "EnergeticBear", value: 0},
        {x: "EquationGroup", value: 0},
        {x: "GorgonGroup", value: 0},
        {x: "Winnti", value: 0},
        <?php
              while($row = $result->fetch_assoc()) {
           echo "{x: '". $row["BYTECODE_VIEW_PREDICTION"]."', value:" . $row["BYTECODE_VIEW_ACCURACY"]. "},";
           echo "{x: '". $row["OPCODE_VIEW_PREDICTION"]."', value:" . $row["OPCODE_VIEW_ACCURACY"]. "},";
           echo "{x: '". $row["HEADER_VIEW_PREDICTION"]."', value:" . $row["HEADER_VIEW_ACCURACY"]. "},"; 
           } 
            mysqli_data_seek($result ,0);
          ?>
        
      ];


      // create radar chart
      var chart = anychart.radar();
      // set chart yScale settings
      chart.yScale()
        .minimum(0)
        .maximum(100)
        .ticks({'interval':10});

      // create first series
      chart.line(data1)

      // set chart title
      chart.title("Campaign Prediction Confidence Rate");

      // set container id for the chart
      chart.container('radarchart');
      // initiate chart drawing
      chart.draw();

    });
  </script>

 <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {
        'packages':['geochart'],
        // Note: you will need to get a mapsApiKey for your project.
        // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
        'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
      });
      google.charts.setOnLoadCallback(drawRegionsMap);

      function drawRegionsMap() {
        var data = google.visualization.arrayToDataTable([
          ['Country', 'Confidence Rate'],
          <?php
              while($row = $result->fetch_assoc()) { 
           echo "['". $row["NATION_STATE"]."', ". $row["BYTECODE_VIEW_ACCURACY"]."],";
           }
            mysqli_data_seek($result ,0);
          ?>
        ]);

        var options = {};

        var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

        chart.draw(data, options);
      }
    </script>

<div class="container">
 <div id="radarchart" class="fixed" ></div>
  <div id="regions_div" class="flex-item"></div>
 

</div>




<?php
echo '<table id="t01">
  <tr>
    <th>SHA256 HASH</th>
    <th>MULTI VIEW PREDICTION</th>
    <th>THREAT PROFILE</th>
    <th>ACTION</th>
  </tr>';
  // output data of each row
  while($row = $result->fetch_assoc()) {
    echo "<tr><td>" . $row["SHA256_HASH"]. "</td><td>" . $row["MULTI_CLASS_PREDICTION"]. "</td><td>" .$row["multi_class_apt_profile"]. "</td><td>" . $row["ACTION"]. "</td></tr>";
  }
} else {
  echo "The uploaded file needs to analysed further. The result will be sent to your email id.";
}
$conn->close();
?>
</table>

</div>


<div id="BytecodeView" class="tabcontent">

<?php
$target_dir = "/var/www/html/uploads/";
$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
$uploadOk = 1;
$imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));
// Calculate SHA256 hash
if(isset($_POST["submit"])) {
 $sha256file = hash_file( 'sha256', $_FILES["fileToUpload"]["tmp_name"] );//true
 $md5file = sha1_file($_FILES["fileToUpload"]["tmp_name"]);
 //echo $sha256file;
 $uploadOk = 1;
}


$servername = "localhost";
$username = "s20";
$password = "malware";

// Create connection
$conn = new mysqli($servername, $username, $password);

// Check connection
if ($conn->connect_error) {
  die("Connection failed: " . $conn->connect_error);
}
//echo "Connected successfully";

$sql = "SELECT SHA256_HASH, BYTECODE_VIEW_PREDICTION,BYTECODE_VIEW_ACCURACY,  OPCODE_VIEW_PREDICTION,OPCODE_VIEW_ACCURACY, HEADER_VIEW_PREDICTION,HEADER_VIEW_ACCURACY, MULTI_CLASS_PREDICTION, multi_class_apt_profile,NATION_STATE  FROM mysql.CTA_ATTRIBUTION_T T WHERE T.SHA256_HASH= '$sha256file' ";
$result = $conn->query($sql);
//$numrows = mysql_num_rows($result);
//echo mysql_num_rows($result);
//var_dump($result);
if ($result->num_rows > 0) {
       
           
?>

<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-radar.min.js"></script>
 <script>
    anychart.onDocumentReady(function () {
    // our data from bulbapedia
      var data1 = [
        {x: "APT1", value: 0},
        {x: "APT10", value: 0},
        {x: "APT19", value: 0},
        {x: "APT21", value: 0},
        {x: "APT28", value: 0},
        {x: "APT29", value: 0},
        {x: "APT30", value: 0},
        {x: "DarkHotel", value: 0},
        {x: "EnergeticBear", value: 0},
        {x: "EquationGroup", value: 0},
        {x: "GorgonGroup", value: 0},
        {x: "Winnti", value: 0},
        <?php
              while($row = $result->fetch_assoc()) {
           echo "{x: '". $row["BYTECODE_VIEW_PREDICTION"]."', value:" . $row["BYTECODE_VIEW_ACCURACY"]. "},";
           } 
            mysqli_data_seek($result ,0);
          ?>
        
      ];


      // create radar chart
      var chart = anychart.radar();
      // set chart yScale settings
      chart.yScale()
        .minimum(0)
        .maximum(100)
        .ticks({'interval':10});

      // create first series
      chart.line(data1)

      // set chart title
      chart.title("Campaign Prediction Confidence Rate");

      // set container id for the chart
      chart.container('radarchart2');
      // initiate chart drawing
      chart.draw();

    });
  </script>


<div class="container">
 <div id="radarchart2" class="fixed"></div>
 
</div>




<?php
echo '<table id="t01">
  <tr>
    <th>SHA256 HASH</th>
    <th>BYTECODE VIEW PREDICTION</th> 
  </tr>';
  // output data of each row
  while($row = $result->fetch_assoc()) {
    echo "<tr><td>" . $row["SHA256_HASH"]. "</td><td>" . $row["BYTECODE_VIEW_PREDICTION"]. "</td></tr>";
  }
} else {
  echo "The uploaded file needs to analysed further. The result will be sent to your email id.";
}
$conn->close();
?>
</table>
</div>

<div id="OpcodeView" class="tabcontent">

<?php
$target_dir = "/var/www/html/uploads/";
$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
$uploadOk = 1;
$imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));
// Calculate SHA256 hash
if(isset($_POST["submit"])) {
 $sha256file = hash_file( 'sha256', $_FILES["fileToUpload"]["tmp_name"] );//true
 $md5file = sha1_file($_FILES["fileToUpload"]["tmp_name"]);
 //echo $sha256file;
 $uploadOk = 1;
}


$servername = "localhost";
$username = "s20";
$password = "malware";

// Create connection
$conn = new mysqli($servername, $username, $password);

// Check connection
if ($conn->connect_error) {
  die("Connection failed: " . $conn->connect_error);
}
//echo "Connected successfully";

$sql = "SELECT SHA256_HASH, BYTECODE_VIEW_PREDICTION,BYTECODE_VIEW_ACCURACY,  OPCODE_VIEW_PREDICTION,OPCODE_VIEW_ACCURACY, HEADER_VIEW_PREDICTION,HEADER_VIEW_ACCURACY, MULTI_CLASS_PREDICTION, multi_class_apt_profile,NATION_STATE  FROM mysql.CTA_ATTRIBUTION_T T WHERE T.SHA256_HASH= '$sha256file' ";
$result = $conn->query($sql);
//$numrows = mysql_num_rows($result);
//echo mysql_num_rows($result);
//var_dump($result);
if ($result->num_rows > 0) {
       
           
?>


<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-radar.min.js"></script>
 <script>
    anychart.onDocumentReady(function () {
    // our data from bulbapedia
      var data1 = [
        {x: "APT1", value: 0},
        {x: "APT10", value: 0},
        {x: "APT19", value: 0},
        {x: "APT21", value: 0},
        {x: "APT28", value: 0},
        {x: "APT29", value: 0},
        {x: "APT30", value: 0},
        {x: "DarkHotel", value: 0},
        {x: "EnergeticBear", value: 0},
        {x: "EquationGroup", value: 0},
        {x: "GorgonGroup", value: 0},
        {x: "Winnti", value: 0},
        <?php
              while($row = $result->fetch_assoc()) {
           echo "{x: '". $row["OPCODE_VIEW_PREDICTION"]."', value:" . $row["OPCODE_VIEW_ACCURACY"]. "},";
           } 
            mysqli_data_seek($result ,0);
          ?>
        
      ];


      // create radar chart
      var chart = anychart.radar();
      // set chart yScale settings
      chart.yScale()
        .minimum(0)
        .maximum(100)
        .ticks({'interval':10});

      // create first series
      chart.line(data1)

      // set chart title
      chart.title("Campaign Prediction Confidence Rate");

      // set container id for the chart
      chart.container('radarchart3');
      // initiate chart drawing
      chart.draw();

    });
  </script>

<div class="container">
 <div id="radarchart3" class="fixed"></div>
 
 
</div>




<?php
echo '<table id="t01">
  <tr>
    <th>SHA256 HASH</th>
    <th>OPCODE VIEW PREDICTION</th>
  </tr>';
  // output data of each row
  while($row = $result->fetch_assoc()) {
    echo "<tr><td>" . $row["SHA256_HASH"]. "</td><td>"  . $row["OPCODE_VIEW_PREDICTION"]. "</td></tr>";
  }
} else {
  echo "The uploaded file needs to analysed further. The result will be sent to your email id.";
}
$conn->close();
?>
</table>

</div>

<div id="HeaderView" class="tabcontent">

<?php
$target_dir = "/var/www/html/uploads/";
$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
$uploadOk = 1;
$imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));
// Calculate SHA256 hash
if(isset($_POST["submit"])) {
 $sha256file = hash_file( 'sha256', $_FILES["fileToUpload"]["tmp_name"] );//true
 $md5file = sha1_file($_FILES["fileToUpload"]["tmp_name"]);
 //echo $sha256file;
 $uploadOk = 1;
}


$servername = "localhost";
$username = "s20";
$password = "malware";

// Create connection
$conn = new mysqli($servername, $username, $password);

// Check connection
if ($conn->connect_error) {
  die("Connection failed: " . $conn->connect_error);
}
//echo "Connected successfully";

$sql = "SELECT SHA256_HASH, BYTECODE_VIEW_PREDICTION,BYTECODE_VIEW_ACCURACY,  OPCODE_VIEW_PREDICTION,OPCODE_VIEW_ACCURACY, HEADER_VIEW_PREDICTION,HEADER_VIEW_ACCURACY, MULTI_CLASS_PREDICTION, multi_class_apt_profile,NATION_STATE  FROM mysql.CTA_ATTRIBUTION_T T WHERE T.SHA256_HASH= '$sha256file' ";
$result = $conn->query($sql);
//$numrows = mysql_num_rows($result);
//echo mysql_num_rows($result);
//var_dump($result);
if ($result->num_rows > 0) {
       
           
?>



<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-core.min.js"></script>
<script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-radar.min.js"></script>
 <script>
    anychart.onDocumentReady(function () {
    // our data from bulbapedia
      var data1 = [
        {x: "APT1", value: 0},
        {x: "APT10", value: 0},
        {x: "APT19", value: 0},
        {x: "APT21", value: 0},
        {x: "APT28", value: 0},
        {x: "APT29", value: 0},
        {x: "APT30", value: 0},
        {x: "DarkHotel", value: 0},
        {x: "EnergeticBear", value: 0},
        {x: "EquationGroup", value: 0},
        {x: "GorgonGroup", value: 0},
        {x: "Winnti", value: 0},
        <?php
              while($row = $result->fetch_assoc()) {
           echo "{x: '". $row["HEADER_VIEW_PREDICTION"]."', value:" . $row["HEADER_VIEW_ACCURACY"]. "},";
           } 
            mysqli_data_seek($result ,0);
          ?>
        
      ];


      // create radar chart
      var chart = anychart.radar();
      // set chart yScale settings
      chart.yScale()
        .minimum(0)
        .maximum(100)
        .ticks({'interval':10});

      // create first series
      chart.line(data1)

      // set chart title
      chart.title("Campaign Prediction Confidence Rate");

      // set container id for the chart
      chart.container('radarchart4');
      // initiate chart drawing
      chart.draw();

    });
  </script>


<div class="container">
 <div id="radarchart4" class="fixed" ></div>
</div>




<?php
echo '<table id="t01">
  <tr>
    <th>SHA256 HASH</th>
    <th>HEADER VIEW PREDICTION</th>
  </tr>';
  // output data of each row
  while($row = $result->fetch_assoc()) {
    echo "<tr><td>" . $row["SHA256_HASH"]. "</td><td>" .$row["HEADER_VIEW_PREDICTION"]. "</td></tr>";
  }
} else {
  echo "The uploaded file needs to analysed further. The result will be sent to your email id.";
}
$conn->close();
?>
</table>

</div>

<script>
function openCity(evt, cityName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}
document.getElementById("defaultOpen").click();
</script>


</body>
</html>
